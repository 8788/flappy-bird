!function(a,b){var c=b.getElementById("main"),d=b.getElementById("score"),e=b.getElementById("ready"),f=b.getElementById("over"),g=b.getElementById("panel"),h=b.getElementById("restart"),i=b.getElementById("start"),j=b.getElementById("fly"),k=b.getElementById("across"),l=b.getElementById("end"),m="start",n=200,o=0,p={ele:b.getElementById("lawn"),start:function(){var a=this.ele,b=parseInt(util.getStyle(a,"width"),10),c=5;a.timer=setInterval(function(){a.offsetLeft<-b/2&&(a.style.left=0),a.style.left=a.offsetLeft-c+"px"},30)},stop:function(){clearInterval(this.ele.timer)}},q={ele:b.getElementById("pillar"),init:function(){for(var a="",b=0;3>b;b++){var d=this._randomPillarHeight();a+='<div class="item" style="left: '+n*b+'px"><div class="item-up" style="height: '+d.up+'px"></div><div class="item-down" style="height: '+d.down+'px"></div></div>'}this.ele.innerHTML=a,this.ele.style.left=2*c.offsetWidth+"px"},start:function(){var a=this,b=a.ele;b.timer=setInterval(function(){b.style.left=b.offsetLeft-4+"px";for(var c=b.children,d=0,e=c.length;e>d;d++)a._check(r,c[d])&&t.over(),t.updateScore(a.bird,c[d]);if(b.offsetLeft<=-n){var f=b.appendChild(b.children[0]),g=a._randomPillarHeight();f.children[0].style.height=g.up,f.children[1].style.height=g.down,a._setPillarPosition(),b.style.left=0}},30)},stop:function(){clearInterval(this.ele.timer)},_randomPillarHeight:function(){var a=c.offsetHeight,b=parseInt(Math.random()*(a-140-140),10)+70,d=a-140-b;return{up:b,down:d}},_setPillarPosition:function(){for(var a=0;3>a;a++)this.ele.children[a].style.left=n*a+"px"},_overlay:function(a,b,c,d,e,f,g,h){return a+c>e&&e+e>a&&b+d>f&&f+h>b?!0:!1},_check:function(a,b){var c=q.ele.offsetLeft,d=10,e={x:b.offsetLeft+c+d,y:0,w:69-2*d,h:b.children[0].offsetHeight},f={x:b.offsetLeft+c+d,y:b.children[1].offsetTop,w:69-2*d,h:b.children[1].offsetHeight};return this._overlay(a.x,a.y,a.w,a.h,e.x,e.y,e.w,e.h)||this._overlay(a.x,a.y,a.w,a.h,f.x,f.y,f.w,f.h)}},r={ele:b.getElementById("bird"),x:90,y:0,w:44,h:30,g:1.5,jumpHeight:60,fly:function(){var a=this,b=a.ele,d=0,e=0,f=Math.sqrt(2*a.g*a.jumpHeight),g=parseInt(b.style.bottom,10),h=c.offsetHeight-b.offsetHeight;g>=h||(clearInterval(b.timer),b.timer=setInterval(function(){d+=.9;var c=f*d-a.g*d*d*.5,h=g+c;0>=h&&t.over(),e=parseInt(g-h)/2,e>90&&(e=90),-30>e&&(e=-30),a.rotate(e),b.style.bottom=h+"px",a.y=b.offsetTop},30))},rotate:function(a){this.ele.style.webkitTransform="rotate("+a+"deg)",this.ele.style.mozTransform="rotate("+a+"deg)",this.ele.style.transform="rotate("+a+"deg)"},died:function(){clearInterval(this.ele.timer),util.addClass(r.ele,"died"),parseInt(this.ele.style.bottom,10)>30&&util.animate(this.ele,{bottom:0},{time:500,type:"easeIn"}),util.animate(f,{top:140},{time:500,type:"buffer"}),this.rotate(90)}},s={start:function(){i.play()},fly:function(){j.play()},across:function(){k.play()},end:function(){l.play()}},t={init:function(){e.style.display="block",q.init(),p.start(),this.addEvent()},addEvent:function(){var a=this;b.onkeydown=function(b){var c=b||event;32===c.keyCode&&(a.paly(),s.fly())},h.onclick=function(){a.reset()}},paly:function(){"start"===m&&(this.start(),m="play"),r.fly()},start:function(){q.start(),util.animate(e,{opacity:0},{time:500})},reset:function(){m="start",d.style.cssText="",e.style.cssText="",e.style.display="block",f.style.cssText="",r.ele.style.bottom="200px",r.rotate(0),util.removeClass(r.ele,"died"),d.innerHTML=0,o=0,this.init(),s.start()},over:function(){b.onkeydown=null,p.stop(),q.stop(),r.died(),s.end(),d.style.display="none",g.children[0].innerHTML=o;try{var a=localStorage.getItem("flappyBirdBestScore")||0;o>=a&&(a=o),g.children[1].innerHTML=a,localStorage.setItem("flappyBirdBestScore",a)}catch(c){g.children[1].innerHTML=o}},updateScore:function(a,b){var c={x:90},e={x:b.offsetLeft+q.ele.offsetLeft,w:69};c.x>e.x&&c.x<=e.x+e.w&&(b.crossing=!0),c.x>e.x+e.w&&b.crossing&&(o+=1,b.crossing=!1,d.innerHTML=o,s.across())}};a.game=t}(window,document);var util=function(a,b){function c(a,b){return a.currentStyle?a.currentStyle[b]:getComputedStyle(a,!1)[b]}function d(a,c){if(c=c||b,c.getElementsByClassName)return c.getElementsByClassName(a);for(var d=new RegExp("(^|\\s)"+a+"($|\\s)","i"),e=[],f=c.getElementsByTagName("*"),g=0,h=f.length;h>g;g++)d.test(f[g].className)&&e.push(f[g]);return e}function e(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,function(){c.call(a,event)}):a["on"+b]=function(a){var b=a||event;c(b)}}function f(a,b){if(a.classList)return a.classList.contains(b);var c=new RegExp("(^|\\s)"+b+"($|\\s)","i");return c.test(a.className)}function g(a,b){f(a,b)||(a.classList?a.classList.add(b):a.className=(a.className.trim()+" "+b).trim())}function h(a,b){if(f(a,b))if(a.classList)a.classList.remove(b);else{var c=new RegExp("(^|\\s+)"+b+"($|\\s+)","ig");a.className=a.className.replace(c," ").trim()}}function i(a,b){f(a,b)?h(a,b):g(a,b)}function j(a,b,d){d=d||{},d.time=d.time||800,d.type=d.type||"buffer";var e=Math.round(d.time/30),f={},g={},h=0;for(var i in b)f[i]="opacity"===i?parseInt(100*c(a,i),10):parseInt(c(a,i),10),g[i]=b[i]-f[i];clearInterval(a.timer),a.timer=setInterval(function(){h++;var c,i;for(var j in b){switch(d.type){case"linear":c=f[j]+g[j]*h/e;break;case"buffer":i=1-h/e,c=f[j]+g[j]*(1-i*i*i);break;case"easeIn":i=h/e,c=f[j]+g[j]*i*i*i}"opacity"===j?(a.style.filter="alpha(opacity"+c+")",a.style.opacity=c/100):a.style[j]=c+"px"}h===e&&(clearInterval(a.timer),d.end&&d.end())},30)}return a.console||(a.console={log:function(){},error:function(){}}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xa0\u3000\u00A0]+|[\s\uFEFF\xa0\u3000\u00A0]+$/g,"")}),{getStyle:c,getByClass:d,bindEvent:e,hasClass:f,addClass:g,removeClass:h,toggleClass:i,animate:j}}(window,document);